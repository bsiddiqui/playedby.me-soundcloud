<head>
  <script src="https://w.soundcloud.com/player/api.js" type="text/javascript"></script>

</head>
<h1>Welcome to <%= @party_profile.name%></h1>


<object height="81" width="100%" id="myPlayer" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">
  <iframe id="sc-widget" width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http://api.soundcloud.com/tracks/<%= @firstsong %>&show_artwork=true&liking=false&sharing=false&frameborder="no"&scrolling="no"&enable_api=true&object_id=myPlayer"></iframe>
</object>
<script src="https://w.soundcloud.com/player/api.js" type="text/javascript"></script>

<br>
<br>
<div class="span12">
  <div class="well">
    <h3> Add Songs</h3>

    <form action='/searchsongs'>
      <input id="songname" name="name" type="text" placeholder="Enter Song Name"/>
      <br>
      <input id="partyprofileid" name="party_profile_id" type="hidden" value= "<%= @party_profile.id%>"/>
      <input id="songsearch" type='submit' value='Search' class="btn btn-primary"/>
    </form>   
    <div class="song_results">
    </div>
  </div>
</div>
</div>

</div>
</div>



<div class="span12">
  <div class="well">
    <h3> Playlist </h3>
    
    <div class="playlist">
      <table class='table table-striped'>
        <tbody class ="playlist-refresh">
          <% @playlist.each_with_index do |s,i| %>
          <tr>
            <td class = "td">
              <div class = "delete">
                <%= button_to "X", { :controller => "songs", :action => "destroy", :party_profile_id => s.party_profile_id, :name => s.name}, :confirm => "Delete this song?", :method => :delete, :class => "btn btn-inverse" %>
              </div> 
            </td>
            <td>
              <%= "#{i+1}" %>.

              <%= s.name %>   
            </td>

            <td>
              <div class = "button2"> 
                <span style = "float:right;"> 

                  <%= form_for [@song], :html => {:method => 'get'} do |f|%>

                  <%= f.hidden_field :name, {:value => s.name} %>
                  <%= f.hidden_field :party_profile_id, {:value => s.party_profile_id} %>
                  <%= f.submit "Down", :class => "btn btn-danger" %>
                  <% end %>
                </span>
                <div class = "buttons_holder">
                  <div class = "button1">
                    <span style = "float:right;">
                      <%= form_for [@song], :html => {:method => 'get'} do |f|%>
                      <%= f.hidden_field :name, {:value => s.name}%>
                      <%= f.hidden_field :party_profile_id, {:value => s.party_profile_id}%>
                      <%= f.submit "Up", :class => "btn btn-success" %>
                      <% end %>   
                    </span> 
                  </div>

                  <span style = "float:left;">
                    <%= s.totalVotes %>
                  </span>

                </div>
              </div>
            </td>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<script>
$('#songsearch').click(function(event) 
{
  var name = $('#songname').val()
  $.get('/searchsongs?name='+name+('&party_profile_id=')+$('#partyprofileid').val(), function(data) 
  {
    console.log(data);
    $('.song_results').html('');
    $('.song_results').append(data);
  });
  return false
});
</script>

